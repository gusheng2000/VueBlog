{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nexport default {\n  name: \"Header\",\n  data: function data() {\n    return {\n      header: {\n        'auth': '2C88CB2140E3DFB8666686765EF17A4F'\n      },\n      isShow: false,\n      user: {\n        username: '请先登录',\n        avatar: 'https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png'\n      },\n      haslogin: false\n    };\n  },\n  methods: {\n    //修改头像\n    uploadOK: function uploadOK(res) {\n      var _this = this;\n\n      console.log(res);\n      this.user.avatar = res.data;\n      this.isShow = false;\n      var img = res;\n      this.$axios.post('/avatar?userId=' + this.$store.getters.getUser.id + \"&avatar=\" + res.data).then(function (res) {\n        console.log(res);\n\n        _this.$message.success(res.data.msg);\n\n        var user = _this.$store.getters.getUser;\n        user.avatar = img.data;\n\n        _this.$store.commit('SET_USERINFO', user);\n      });\n    },\n    uploadImg: function uploadImg() {\n      this.isShow = true;\n    },\n    logout: function logout() {\n      var _this2 = this;\n\n      this.$axios.get(\"/logout\", {\n        headers: {\n          \"authorization\": localStorage.getItem(\"token\")\n        }\n      }).then(function (res) {\n        console.log(_this2);\n\n        _this2.$store.commit(\"REMOVE_INFO\");\n\n        _this2.$router.push(\"/login\");\n      });\n    }\n  },\n  created: function created() {\n    if (this.$store.getters.getUser) {\n      this.user.username = this.$store.getters.getUser.username;\n      this.user.avatar = this.$store.getters.getUser.avatar;\n      this.haslogin = true;\n    }\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoDA;EACAA,cADA;EAEAC,IAFA,kBAEA;IACA;MACAC;QAAA;MAAA,CADA;MAEAC,aAFA;MAGAC;QACAC,gBADA;QAEAC;MAFA,CAHA;MAOAC;IAPA;EASA,CAZA;EAaAC;IACA;IACAC,QAFA,oBAEAC,GAFA,EAEA;MAAA;;MACAC;MACA;MACA;MAEA;MACA,6FACAC,IADA,CACA;QACAD;;QACA;;QACA;QACAP;;QACA;MACA,CAPA;IAQA,CAhBA;IAiBAS,SAjBA,uBAiBA;MACA;IACA,CAnBA;IAoBAC,MApBA,oBAoBA;MAAA;;MACA;QACAC;UACA;QADA;MADA,GAIAH,IAJA,CAIA;QACAD;;QACA;;QACA;MACA,CARA;IASA;EA9BA,CAbA;EA6CAK,OA7CA,qBA6CA;IACA;MACA;MACA;MACA;IACA;EACA;AAnDA","names":["name","data","header","isShow","user","username","avatar","haslogin","methods","uploadOK","res","console","then","uploadImg","logout","headers","created"],"sourceRoot":"src/components","sources":["Header.vue"],"sourcesContent":["<template>\r\n    <div class=\"m-content\">\r\n        <h2>欢迎来到SC博客</h2>\r\n        <div class=\"block\">\r\n            <el-avatar :size=\"80\" :src=\"user.avatar\"></el-avatar>\r\n            <div>{{user.username}}</div>\r\n        </div>\r\n\r\n        <div class=\"maction\">\r\n            <span> <el-link href=\"/blogs\">主页</el-link></span>\r\n            <el-divider direction=\"vertical\"></el-divider>\r\n            <span> <el-link type=\"success\" href=\"/blog/add\">发表</el-link></span>\r\n\r\n            <span v-show=\"haslogin\"> <el-link  type=\"danger\"  @click=\"uploadImg\">\r\n                <el-divider direction=\"vertical\"></el-divider>头像</el-link></span>\r\n\r\n            <el-divider direction=\"vertical\"></el-divider>\r\n            <span v-show=\"!haslogin\"> <el-link type=\"info\" href=\"/login\">登陆</el-link></span>\r\n\r\n            <span v-show=\"haslogin\"> <el-link type=\"danger\" @click=\"logout\">退出</el-link></span>\r\n        </div>\r\n        <div>\r\n\r\n            <el-dialog\r\n                    title=\"上传你的头像\"\r\n                    :visible.sync=\"isShow\"\r\n                    width=\"50%\"\r\n                    >\r\n                <div>\r\n                    <el-upload\r\n                            class=\"upload-demo\"\r\n                            drag\r\n                            name=\"file\"\r\n                            :headers=\"header\"\r\n                            action=\"http://150.158.81.243:8081/savePicture\"\r\n                            :on-success=\"uploadOK\"\r\n                            multiple>\r\n                        <i class=\"el-icon-upload\"></i>\r\n                        <div class=\"el-upload__text\">将文件拖到此处，或<em>点击上传</em></div>\r\n                        <div class=\"el-upload__tip\" slot=\"tip\">只能上传jpg/png文件，且不超过500kb</div>\r\n                    </el-upload>\r\n                </div>\r\n            </el-dialog>\r\n        </div>\r\n\r\n\r\n    </div>\r\n\r\n\r\n</template>\r\n\r\n<script>\r\n    export default {\r\n        name: \"Header\",\r\n        data() {\r\n            return {\r\n                header: {'auth': '2C88CB2140E3DFB8666686765EF17A4F'},\r\n                isShow: false,\r\n                user: {\r\n                    username: '请先登录',\r\n                    avatar: 'https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png'\r\n                },\r\n                haslogin: false\r\n            }\r\n        },\r\n        methods: {\r\n            //修改头像\r\n            uploadOK(res){\r\n                console.log(res);\r\n                this.user.avatar=res.data\r\n                this.isShow=false\r\n\r\n                let img=res\r\n                this.$axios.post('/avatar?userId='+this.$store.getters.getUser.id+\"&avatar=\"+res.data)\r\n                    .then(res=>{\r\n                        console.log(res);\r\n                        this.$message.success(res.data.msg)\r\n                        let user = this.$store.getters.getUser;\r\n                        user.avatar=img.data\r\n                        this.$store.commit('SET_USERINFO',user)\r\n                    })\r\n            },\r\n            uploadImg() {\r\n                    this.isShow=true\r\n            },\r\n            logout() {\r\n                this.$axios.get(\"/logout\", {\r\n                    headers: {\r\n                        \"authorization\": localStorage.getItem(\"token\")\r\n                    }\r\n                }).then(res => {\r\n                    console.log(this)\r\n                    this.$store.commit(\"REMOVE_INFO\")\r\n                    this.$router.push(\"/login\")\r\n                })\r\n            }\r\n        },\r\n        created() {\r\n            if (this.$store.getters.getUser) {\r\n                this.user.username = this.$store.getters.getUser.username\r\n                this.user.avatar = this.$store.getters.getUser.avatar\r\n                this.haslogin = true\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n    .m-content {\r\n        max-width: 960px;\r\n        margin: 0 auto;\r\n        text-align: center;\r\n        \r\n    }\r\n\r\n    .maction {\r\n        margin: 10px 0px;\r\n    }\r\n</style>"]},"metadata":{},"sourceType":"module"}